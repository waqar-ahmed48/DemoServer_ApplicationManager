version: "3.9"
services:
  web:
    build: 
      context: .
      dockerfile: dockerfile
    image: demoserver_applicationmanager:latest
    environment:
      - DEMOSERVER_APPLICATIONMANAGER_VAULT_HOST=${DEMOSERVER_APPLICATIONMANAGER_VAULT_HOST}
      - DEMOSERVER_APPLICATIONMANAGER_VAULT_PORT=${DEMOSERVER_APPLICATIONMANAGER_VAULT_PORT}
      - DEMOSERVER_APPLICATIONMANAGER_VAULT_ROLE_ID=${DEMOSERVER_APPLICATIONMANAGER_VAULT_ROLE_ID}
      - DEMOSERVER_APPLICATIONMANAGER_VAULT_SECRET_ID=${DEMOSERVER_APPLICATIONMANAGER_VAULT_SECRET_ID}
      - DEMOSERVER_APPLICATIONMANAGER_VAULT_TLSSKIPVERIFY=${DEMOSERVER_APPLICATIONMANAGER_VAULT_TLSSKIPVERIFY}
      - DEMOSERVER_APPLICATIONMANAGER_POSTGRES_SSLMODE=${DEMOSERVER_APPLICATIONMANAGER_POSTGRES_SSLMODE}
      - DEMOSERVER_APPLICATIONMANAGER_POSTGRES_HOST=${DEMOSERVER_APPLICATIONMANAGER_POSTGRES_HOST}
      - DEMOSERVER_APPLICATIONMANAGER_POSTGRES_PORT=${DEMOSERVER_APPLICATIONMANAGER_POSTGRES_PORT}
      - DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RO_USERNAME=${DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RO_USERNAME}
      - DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RW_USERNAME=${DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RW_USERNAME}
      - DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RO_PASSWORD=${DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RO_PASSWORD}
      - DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RW_PASSWORD=${DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RW_PASSWORD}
      - DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RO_CONNECTIONPOOLSIZE=${DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RO_CONNECTIONPOOLSIZE}
      - DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RW_CONNECTIONPOOLSIZE=${DEMOSERVER_APPLICATIONMANAGER_POSTGRES_RW_CONNECTIONPOOLSIZE}
    network_mode: "host"
    restart: always